<div class="container">
    {{>nav}}
</div>

<div class="wrapper-all">
    <div class="fixed-bg bg-5">
        <div class="container container-dash" id="dash">
            <div class="row page-wrap scroll-bg justify-content-center">
                <div class="dash-header">
                    <h1 class="h1-all">DREAM DASHBOARD</h1>
                </div>
                <div class=" col-sm col-md-4">
                    <canvas id="myChart"></canvas>
                </div>

                <div class="col-sm col-md-4">
                    <canvas id="myChart2"></canvas>
                </div>

                <div class="col-sm col-md-4">
                    <canvas id="myChart3"></canvas>
                </div>

                <div class="row dash-4">
                    <canvas id="myChart4"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>


<div class="footer">
    <p>copyright 2021 DREAMSCAPE, jenner garcia</p>
</div>


<script>

    let myChart = document.getElementById("myChart").getContext("2d");


    let lucid;
    let nightmare;
    let recdream;
    let rectheme;
    let arrmood = [];
    let sad;
    let neutral;
    let mood;
    let count;
    let dreams;
    fetch("/api/dreams/dash")
        .then(res => res.json())
        .then((data) => {
            console.log(data);
            dreams = data;
            lucid = data.filter((object) => object.lucid);
            nightmare = data.filter((object) => object.nightmare);
            recdream = data.filter((object) => object.recdream);
            rectheme = data.filter((object) => object.rectheme);

            neutral = data.reduce(function (n, object) {
                return n + (object.mood == 'neutral');
            }, 0);

            mood = data.reduce(function (n, object) {
                return n + (object.mood == 'frightened');
            }, 0);
            console.log(mood)


            mood = data.map((item) => {
                arrmood.push(item.mood);
                console.log(arrmood)
            });

            count = {};
            arrmood.forEach(function (i) { count[i] = (count[i] || 0) + 1; });
            count = JSON.stringify(count);
            console.log(count);





            let massPopChart = new Chart(myChart, {
                type: "pie",  //bar, horizontal, pie, line, doughnut, radar, polar
                data: {
                    labels: ["Lucid", "Non-Lucid"],
                    datasets: [{
                        label: "Population",
                        data: [

                            (lucid.length / dreams.length) * 100, ((dreams.length - lucid.length) / dreams.length * 100),

                        ],
                        //backgroundColor: "green"
                        backgroundColor: [
                            "rgb(254, 254, 160)",
                            "#000"
                        ],
                        borderWidth: 3,
                        borderColor: "#777",
                        hoverBorderWidth: "#000",
                        hoverBorderColor: "#000"
                    }]
                },
                options: { //these can be altered/deleted
                    title: {
                        display: true, //or false for other charts
                        text: "Lucidity",
                        fontSize: 25,
                        fontColor: "#fff"
                    },
                    legend: {
                        display: false,
                        position: "right", //can change
                        labels: {
                            fontColor: "#000"
                        }
                    },
                    layout: {
                        padding: {
                            left: 50,
                            right: 0,
                            bottom: 0,
                            top: 0
                        }
                    },
                    tooltips: {
                        enabled: true // or true
                    }
                }

            });
            ///////
            let myChart2 = document.getElementById("myChart2").getContext("2d");


            let nightmares = new Chart(myChart2, {
                type: "pie",  //bar, horizontal, pie, line, doughnut, radar, polar
                data: {
                    labels: ["Nightmare", "Non-Nightmare"],
                    datasets: [{
                        label: "Population",
                        data: [
                            (nightmare.length / dreams.length * 100), ((dreams.length - nightmare.length) / dreams.length * 100)
                        ],
                        //backgroundColor: "green"
                        backgroundColor: [
                            "rgb(254, 254, 160)",
                            "#000"
                        ],
                        borderWidth: 3,
                        borderColor: "#777",
                        hoverBorderWidth: "#000",
                        hoverBorderColor: "#000"
                    }]
                },
                options: { //these can be altered/deleted
                    title: {
                        display: true, //or false for other charts
                        text: "Nightmares",
                        fontSize: 25,
                        fontColor: "#fff"
                    },
                    legend: {
                        display: false,
                        position: "right", //can change
                        labels: {
                            fontColor: "#000"
                        }
                    },
                    layout: {
                        padding: {
                            left: 50,
                            right: 0,
                            bottom: 0,
                            top: 0
                        }
                    },
                    tooltips: {
                        enabled: true // or true
                    }
                }

            });

            ///////

            let massPopChart3 = new Chart(myChart3, {
                type: "pie",  //bar, horizontal, pie, line, doughnut, radar, polar
                data: {
                    labels: ["Recurring", "Non-Recurring"],
                    datasets: [{
                        label: "Population",
                        data: [
                            (recdream.length / dreams.length * 100), ((dreams.length - recdream.length) / dreams.length * 100)
                        ],
                        //backgroundColor: "green"
                        backgroundColor: [
                            "rgb(254, 254, 160)",
                            "#000"
                        ],
                        borderWidth: 3,
                        borderColor: "#777",
                        hoverBorderWidth: "#000",
                        hoverBorderColor: "#000"
                    }]
                },
                options: { //these can be altered/deleted
                    title: {
                        display: true, //or false for other charts
                        text: "Recurring",
                        fontSize: 25,
                        fontColor: "#fff"
                    },
                    legend: {
                        display: false,
                        position: "right", //can change
                        labels: {
                            fontColor: "#000"
                        }
                    },
                    layout: {
                        padding: {
                            left: 50,
                            right: 0,
                            bottom: 0,
                            top: 0
                        }
                    },
                    tooltips: {
                        enabled: true // or true
                    }
                }

            });
            ///////



            let massPopChart4 = new Chart(myChart4, {
                type: "polarArea",  //bar, horizontal, pie, line, doughnut, radar, polarArea
                data: {
                    labels: ["Happy", "Sad", "Neutral", "Frightened", "Angry", "Anxious"],
                    datasets: [{
                        label: "Population",
                        data: [
                            (neutral / dreams.length) * 100,

                        ],
                        //backgroundColor: "green"
                        backgroundColor: [
                            "rgba(255, 99, 132, 0.6",
                            "rgba(54, 162, 235, 0.6"
                        ],
                        borderWidth: 3,
                        borderColor: "#777",
                        hoverBorderWidth: "#000",
                        hoverBorderColor: "#000"
                    }]
                },
                options: { //these can be altered/deleted
                    title: {
                        display: true, //or false for other charts
                        text: "Dream Moods",
                        fontSize: 25
                    },
                    legend: {
                        display: false,
                        position: "right", //can change
                        labels: {
                            fontColor: "#000"
                        }
                    },
                    layout: {
                        padding: {
                            left: 50,
                            right: 0,
                            bottom: 0,
                            top: 0
                        }
                    },
                    tooltips: {
                        enabled: true // or true
                    }
                }

            });



        });

    //*****Global Options
    //Chart.defaults.global.defaultFontFamily = "",
    //Chart.defaults.global.defaultFontSize = "",
    //Chart.defaults.global.defaultFontColor = "",


</script>